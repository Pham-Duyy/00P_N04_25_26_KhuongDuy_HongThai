<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Qu·∫£n l√Ω thu chi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #0f172a;
      font-family: "Poppins", sans-serif;
      color: #e2e8f0;
      padding: 24px;
    }
    .glass {
      background: rgba(30, 41, 59, 0.4);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      padding: 32px;
    }
    .tab-active {
      border-bottom: 2px solid #22c55e;
      color: #22c55e;
    }
    .tab-inactive {
      border-bottom: 2px solid transparent;
      color: #94a3b8;
    }
  </style>
</head>
<body>
  <div class="max-w-7xl mx-auto glass">
    <h1 class="text-3xl font-bold text-center mb-6 text-white">
      üí≥ Qu·∫£n l√Ω thu chi
    </h1>

    <!-- Tabs -->
    <div class="flex justify-center space-x-6 mb-6 text-lg font-semibold">
      <button onclick="showTab('thu')" id="tab-thu" class="tab-active">Thu</button>
      <button onclick="showTab('chi')" id="tab-chi" class="tab-inactive">Chi</button>
    </div>

    <!-- N√∫t t·∫°o giao d·ªãch: ch·ªâ hi·ªÉn th·ªã n·∫øu l√† admin -->
<div class="text-center mb-6" th:if="${isAdmin}">
  <a href="/admin/finance/transactions/new" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg shadow">
    <i class="fas fa-plus mr-2"></i> T·∫°o giao d·ªãch m·ªõi
  </a>
</div>


    <!-- Tab Thu -->
    <div id="thu-content">
      <table class="w-full text-sm text-left text-white">
        <thead class="bg-slate-700 text-slate-200 uppercase text-xs">
          <tr>
            <th class="px-4 py-3">ID</th>
            <th class="px-4 py-3">S·ªë ti·ªÅn</th>
            <th class="px-4 py-3">M√¥ t·∫£</th>
            <th class="px-4 py-3">H·∫°ng m·ª•c</th>
            <th class="px-4 py-3">Ng∆∞·ªùi t·∫°o</th>
            <th class="px-4 py-3">Ph√™ duy·ªát?</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="tx : ${transactions}" th:if="${tx.type == 'INCOME'}" class="border-b border-slate-700 hover:bg-slate-700/30 transition">
            <td class="px-4 py-3" th:text="${tx.id}"></td>
            <td class="px-4 py-3 text-green-400 font-semibold" th:text="'+' + ${#numbers.formatDecimal(tx.amount, 0, 'COMMA', '.', '')} + '‚Ç´'"></td>
            <td class="px-4 py-3" th:text="${tx.description}"></td>
            <td class="px-4 py-3" th:text="${tx.category.name}"></td>
            <td class="px-4 py-3" th:text="${tx.createdBy.email}"></td>
            <td class="px-4 py-3">
              <form th:action="@{'/admin/finance/transactions/approve/' + ${tx.id}}" method="post" th:if="${!tx.approved}">
                <button class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-white text-sm">
                  <i class="fas fa-check mr-1"></i>Duy·ªát
                </button>
              </form>
              <span th:if="${tx.approved}" class="text-green-400 font-bold">ƒê√£ duy·ªát</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Tab Chi -->
    <div id="chi-content" class="hidden">
      <table class="w-full text-sm text-left text-white">
        <thead class="bg-slate-700 text-slate-200 uppercase text-xs">
          <tr>
            <th class="px-4 py-3">ID</th>
            <th class="px-4 py-3">S·ªë ti·ªÅn</th>
            <th class="px-4 py-3">M√¥ t·∫£</th>
            <th class="px-4 py-3">H·∫°ng m·ª•c</th>
            <th class="px-4 py-3">Ng∆∞·ªùi t·∫°o</th>
            <th class="px-4 py-3">Ng√†y</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="tx : ${transactions}" th:if="${tx.type == 'EXPENSE'}" class="border-b border-slate-700 hover:bg-slate-700/30 transition">
            <td class="px-4 py-3" th:text="${tx.id}"></td>
            <td class="px-4 py-3 text-red-400 font-semibold" th:text="'-' + ${#numbers.formatDecimal(tx.amount, 0, 'COMMA', '.', '')} + '‚Ç´'"></td>
            <td class="px-4 py-3" th:text="${tx.description}"></td>
            <td class="px-4 py-3" th:text="${tx.category.name}"></td>
            <td class="px-4 py-3" th:text="${tx.createdBy.email}"></td>
            <td th:text="${#temporals.format(tx.date, 'dd/MM/yyyy HH:mm')}"></td>


          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    function showTab(tab) {
      document.getElementById('thu-content').classList.add('hidden');
      document.getElementById('chi-content').classList.add('hidden');
      document.getElementById('tab-thu').classList.remove('tab-active');
      document.getElementById('tab-chi').classList.remove('tab-active');
      document.getElementById('tab-thu').classList.add('tab-inactive');
      document.getElementById('tab-chi').classList.add('tab-inactive');

      if (tab === 'thu') {
        document.getElementById('thu-content').classList.remove('hidden');
        document.getElementById('tab-thu').classList.add('tab-active');
        document.getElementById('tab-thu').classList.remove('tab-inactive');
      } else {
        document.getElementById('chi-content').classList.remove('hidden');
        document.getElementById('tab-chi').classList.add('tab-active');
        document.getElementById('tab-chi').classList.remove('tab-inactive');
      }
    }
  </script>
</body>
</html>
